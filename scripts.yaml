cast_dashboard_keuken:
  sequence:
  - action: cast.show_lovelace_view
    metadata: {}
    data:
      entity_id: media_player.keuken
      view_path: '0'
      dashboard_path: dashboard-keuken
  alias: Cast dashboard-keuken
  description: ''
jeroen_gaat_slapen:
  sequence:
  - action: automation.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: automation.jeroen_gaat_slapen
  alias: Jeroen gaat slapen
  description: ''
  icon: mdi:chat-sleep
het_eten_is_klaar:
  sequence:
  - action: automation.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: automation.eten_klaar
  alias: Het eten is klaar
  description: ''
  icon: mdi:food
telegram_message_familyapp:
  alias: "Centrale Telegram Router"
  description: "Stuurt berichten naar de Test- of Familie-chat op basis van labels."
  fields:
    message_text:
      description: "De tekst van het bericht"
      example: "De wasmachine is klaar"
      required: true
    caller_id:
      description: "ID van de aanroepende automatisering (gebruik {{ this.entity_id }})"
      example: "automation.ip_check"
      required: true
  sequence:
    - variables:
        # Check of 'test' (hoofdletterongevoelig) in de labels staat
        is_test: >
          {{ 'test' in labels(caller_id) | map('lower') | list if caller_id is defined else false }}
        
        # Bepaal de juiste notify entiteit
        target_entity: >
          {% if is_test %}
            notify.telegram_bot_8053303995_15473309
          {% else %}
            notify.telegram_thuisapp
          {% endif %}

    # Voer de actie uit op de gekozen entiteit
    - action: notify.send_message
      target:
        entity_id: "{{ target_entity }}"
      data:
        message: "{{ message_text }}"