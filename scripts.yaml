cast_dashboard_keuken:
  sequence:
  - action: cast.show_lovelace_view
    metadata: {}
    data:
      entity_id: media_player.keuken
      view_path: '0'
      dashboard_path: dashboard-keuken
  alias: Cast dashboard-keuken
  description: ''
jeroen_naar_boven:
  alias: "Jeroen gaat naar boven"
  icon: mdi:stairs-up
  description: "Routine voor het naar boven gaan: Begane grond uit, kantoor aan, muziek starten."
  sequence:
    # 1. Alle verlichting op de begane grond uit (met een korte fade-out)
    - action: light.turn_off
      target:
        floor_id: begane_grond
      data:
        transition: 3

    # 2. Specifieke media-apparaten op de begane grond uitschakelen
    # 'continue_on_error' zorgt ervoor dat het script doorgaat als een TV al uit (of onbereikbaar) is.
    - action: media_player.turn_off
      target:
        entity_id:
          - media_player.tv_woonkamer
          - media_player.sony_xr_65a80j
          - media_player.lg_webos_tv_oled55cx9la
          - media_player.keuken
          - media_player.woonkamer_voor
          - media_player.eetkamer
          - media_player.begane_grond
      continue_on_error: true

    # 3. Lamp kantoor aan
    - action: light.turn_on
      target:
        entity_id: light.lamp_kantoor
    # 4. Shuffle aanzetten op de Nest Hub Kantoor
    - action: media_player.shuffle_set
      target:
        entity_id: media_player.nesthub7b28
      data:
        shuffle: true
        
    # 5. Muziek afspelen via Music Assistant op Nest Hub Kantoor
    - action: music_assistant.play_media
      target:
        entity_id: media_player.nesthub7b28
      data:
        media_type: playlist
        media_id: "Bedtijd Jeroen"
        enqueue: replace
het_eten_is_klaar:
  sequence:
  - action: automation.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: automation.eten_klaar
  alias: Het eten is klaar
  description: ''
  icon: mdi:food
telegram_message_familyapp:
  alias: "Centrale Telegram Router"
  description: "Stuurt berichten naar de Test- of Familie-chat op basis van labels."
  fields:
    message_text:
      description: "De tekst van het bericht"
      example: "De wasmachine is klaar"
      required: true
    caller_id:
      description: "ID van de aanroepende automatisering (gebruik {{ this.entity_id }})"
      example: "automation.ip_check"
      required: true
  sequence:
    - variables:
        # Check of 'test' (hoofdletterongevoelig) in de labels staat
        is_test: >
          {{ 'test' in labels(caller_id) | map('lower') | list if caller_id is defined else false }}
        
        # Bepaal de juiste notify entiteit
        target_entity: >
          {% if is_test %}
            notify.telegram_bot_8053303995_15473309
          {% else %}
            notify.telegram_thuisapp
          {% endif %}

    # Voer de actie uit op de gekozen entiteit
    - action: notify.send_message
      target:
        entity_id: "{{ target_entity }}"
      data:
        message: "{{ message_text }}"